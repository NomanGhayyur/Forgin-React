"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__read=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),l=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)l.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return l},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_this=this,react_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importStar(require("react"))),aphrodite_1=require("../../helpers/aphrodite"),Button_1=__importDefault(require("../Button")),Icon_1=__importDefault(require("../Icon")),Uploader_styles_1=__importDefault(require("./Uploader.styles")),iconType_1=__importDefault(require("./iconType")),Uploader=react_1.default.memo(function(l){var e=l.title,e=void 0===e?"Upload":e,t=l.showList,t=void 0===t||t,r=l.type,r=void 0===r?"light":r,n=l.className,n=void 0===n?"":n,a=l.iconName,a=void 0===a?"upload":a,i=(0,Uploader_styles_1.default)(),o=__read((0,react_1.useState)(l.files||[]),2),u=o[0],c=o[1],o=__read((0,react_1.useState)(""),2),f=o[0],d=o[1],s=(0,react_1.useRef)(null),o=((0,react_1.useEffect)(function(){d(l.error||"")},[l.error]),(0,react_1.useMemo)(function(){return u.map(function(e){return react_1.default.createElement("div",{className:(0,aphrodite_1.css)(i.fileItem),key:e.name},react_1.default.createElement(Icon_1.default,{height:"1.5rem",width:"1.5rem",name:iconType_1.default[e.type]||"paperclip"}),react_1.default.createElement("span",{className:"lead",style:{flex:1}},e.name),react_1.default.createElement(Icon_1.default,{height:"1.5rem",width:"1.5rem",name:"trash",fill:"var(--bs-danger)",onClick:function(t){return c(function(e){return e.filter(function(e){return e.name!=t.name})})}.bind(_this,e)}))})},[u,i]));return(0,react_1.useEffect)(function(){var t,e;if(s.current){var r=new DataTransfer;try{for(var n=__values(u),a=n.next();!a.done;a=n.next()){var i=a.value;r.items.add(i)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}s.current.files=r.files}},[u]),(0,react_1.useEffect)(function(){var e;l.files&&0<(null==(e=l.files)?void 0:e.length)&&c(l.files)},[l.files]),(0,react_1.useEffect)(function(){var e,t;if(s.current)return(e=s.current).addEventListener("field-error",t=function(e){return d(null==(e=e.detail)?void 0:e.error)}),function(){e.removeEventListener("field-error",t)}},[]),react_1.default.createElement("div",{style:l.style,id:l.id,className:"".concat((0,aphrodite_1.css)(i.container)," ").concat(n)},react_1.default.createElement("input",{"data-name":l.name,accept:null==(n=l.accept)?void 0:n.join(","),name:l.name,style:{display:"none"},ref:s,type:"file",multiple:l.multiple,onChange:function(r){var e,n;if(l.multiple){for(var a=Object.assign([],u),t=0;t<((null==(e=r.target.files)?void 0:e.length)||0);t++)!function(e){var t=null==(n=r.target.files)?void 0:n.item(e);t&&!a.some(function(e){return e.name===t.name})&&a.push(t)}(t);c(a),l.onChange&&l.onChange(a)}else{var i=null==(i=r.target.files)?void 0:i.item(0);i&&(c([i]),l.onChange&&l.onChange([i]))}d("")}}),react_1.default.createElement(Button_1.default,{loader:l.loader,block:l.block,disabled:l.disabled,htmlType:"button",outline:l.outline,size:l.size,iconName:a,type:r,onClick:function(){var e;return null==(e=s.current)?void 0:e.click()}},e),f?react_1.default.createElement("span",{className:"invalid-feedback"},f):null,t?o:null)});Uploader.displayName="Uploader",exports.default=Uploader;