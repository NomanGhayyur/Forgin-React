"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var u=Object.getOwnPropertyDescriptor(t,r);u&&("get"in u?t.__esModule:!u.writable&&!u.configurable)||(u={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,u)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},react_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importStar(require("react"))),infinitelist_style_1=__importDefault(require("./infinitelist.style")),InfiniteList=react_1.default.forwardRef(function(r,e){var n=(0,react_1.useRef)(null),t=(0,react_1.useRef)(!0),u=(0,react_1.useRef)(0),i=(0,react_1.useRef)(0),c=(0,react_1.useRef)(r.debounce||1e3),l=r.data,a=r.renderItem,o=r.isReverse,s=((0,infinitelist_style_1.default)(r),(0,react_1.useImperativeHandle)(e,function(){return{set page(e){i.current=e},get page(){return i.current},set debounce(e){c.current=e},get debounce(){return c.current}}}),(0,react_1.useCallback)(function(e){r.hasMore&&(o&&1==t.current&&e.target.scrollTop<=(r.threshold||0)&&(r.onEndReach&&u.current>e.target.scrollTop&&(r.onEndReach(e,i.current),i.current=i.current+1),t.current=!1,setTimeout(function(){return t.current=!0},c.current)),!o&&1==t.current&&e.target.scrollHeight-e.target.scrollTop-(r.threshold||0)<=e.target.clientHeight&&(r.onEndReach&&u.current<e.target.scrollTop&&(r.onEndReach(e,i.current),i.current=i.current+1),t.current=!1,setTimeout(function(){return t.current=!0},c.current)),u.current=e.target.scrollTop)},[o,r])),e=((0,react_1.useEffect)(function(){var e,t;if(0<(null==(e=r.data)?void 0:e.length)&&r.hasMore&&n.current)return null!=(t=n.current.parentElement)&&t.addEventListener("scroll",s),null!=(e=n.current)&&e.remove(),r.isReverse&&null!=t&&t.scrollTo(0,null==t?void 0:t.scrollHeight),function(){null!=t&&t.removeEventListener("scroll",s)}},[s,r]),(0,react_1.useMemo)(function(){return null==l?void 0:l.map(a)},[l,a]));return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("div",{ref:n,style:{display:"none"}}),e)});InfiniteList.defaultProps={threshold:200,debounce:1e3,isReverse:!1,data:[],hasMore:!1,renderItem:function(e){return e}},InfiniteList.displayName="InfiniteList",exports.default=InfiniteList;